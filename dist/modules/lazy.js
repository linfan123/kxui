/**
 * method kxui
 * version 1.3.2
 * author Lkx
 * create time 2018.05.31
 * update time 2018.11.26
 * website http://www.kxui.org
 */

"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(t,e,o){var n={0:"容器 {"+e+"} 不存在",1:"当前页面未发现 <img> 标签",2:"字段 {el} 不能为空",3:"无法找到 {"+e+"} 节点或存在多个 {"+e+"} 节点",4:"节点 {"+e+"} 下不存在子节点或存在多个子节点"};o?console.error("kxui-"+i.version+"： 模块 {lazy} "+n[t]+"。"):console.warn("kxui-"+i.version+"： 模块 {lazy} "+n[t]+"。")}var i=t.kxui,o="undefined"!=typeof module&&"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports),n=function(t,e){this.parameter="object"===("undefined"==typeof t?"undefined":_typeof(t))?t:{},this.type=e,this.variable()};n.prototype={variable:function(){switch(this.type){case 0:this.threshold=Number(this.parameter.threshold)?Number(this.parameter.threshold):0,this.externalContainer=this.parameter.container?i.method.getDom(this.parameter.container):"",this.parameter.container&&!this.externalContainer?e(0,this.parameter.container):this.container();break;case 1:this.el=this.parameter.el,this.call="function"==typeof this.parameter.call?this.parameter.call:function(){},this.dropSwitch=!0,this.el?(this.el=i.method.getDom(this.el),this.el||this.el.length&&1===this.el.length?(this.elChildren=i.method.sonDom(this.el),this.elChildren&&1===this.elChildren.length?this.dynamicStyle():e(4,this.parameter.el,!0)):e(3,this.parameter.el,!0)):e(2)}},dynamicStyle:function(){i.method.addClass(this.el,"kxui-drop"),i.method.addClass(this.elChildren[0],"kxui-drop-children"),i.method.addClass(i.method.getDom("html"),"kxui-drop-html"),i.method.addClass(i.method.getDom("body"),"kxui-drop-body"),this.event()},container:function(){this.img=this.externalContainer?i.method.sonAllDom(this.externalContainer,"img"):i.method.getDom("img"),this.img||this.img.length>0?this["static"]():e(1)},"static":function(){var t=this,e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC";if(this.img.length)for(var o=0;o<this.img.length;o++)i.method.atrDom(this.img[o],"src",e);else i.method.atrDom(this.img,"src",e);t.branch()},branch:function(){var t=this.externalContainer?this.externalContainer.scrollTop:document.documentElement.scrollTop||document.body.scrollTop,e=this.externalContainer?this.externalContainer.clientHeight:document.documentElement.clientHeight||document.body.clientHeight;if(this.img.length)for(var i=0;i<this.img.length;i++)this.exhibition(this.img[i],t,e);else this.exhibition(this.img,t,e);this.event()},event:function(){var e=this;switch(this.type){case 0:var i=e.externalContainer||t;i.onscroll=function(){e.branch()};break;case 1:e.el.onscroll=function(){e.listening()}}},exhibition:function(t,e,o){var n=i.method.atrDom(t,"lazy-src");n&&t.offsetTop-(this.externalContainer?t.parentNode.offsetTop:0)<=e+o+this.threshold&&t.offsetTop+t.offsetHeight-(this.externalContainer?t.parentNode.offsetTop:0)>=e-this.threshold&&n!==i.method.atrDom(t,"src")&&i.method.atrDom(t,"src",n)},listening:function(){this.elTop=this.el.scrollTop,this.elHeight=this.el.offsetHeight,this.elChildrenHeight=this.elChildren[0].offsetHeight,this.elTop+this.elHeight>=this.elChildrenHeight&&this.dropSwitch?(this.dropSwitch=!1,this.call()):this.elTop+this.elHeight<this.elChildrenHeight&&(this.dropSwitch=!0)}};var h=function(){this.name="Lazy",this.info="Lazy load solution"};h.fn=h.prototype,h.fn.load=function(t){this.logic=new n(t,0),delete this.logic},h.fn.drop=function(t){this.logic=new n(t,1),delete this.logic},i.lazy=new h,o&&(i.lazy=module.exports=new h)}(window);