/**
 * method kxui
 * version 1.4.0
 * author Lkx
 * create time 2018.05.31
 * update time 2018.00.00
 * website http://www.kxui.org
 */

"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function t(t){var i=t||e.event;i.stopPropagation()}function i(e,t,i){i="boolean"==typeof i?i:"boolean"==typeof t&&t;var a={0:"字段 {el} 不能为空",1:"无法找到 {"+t+"} 节点"};i?console.error("kxui-"+o.version+"： 模块 {carousel} "+a[e]+"。"):console.warn("kxui-"+o.version+"： 模块 {carousel} "+a[e]+"。")}var o=e.kxui,a="undefined"!=typeof module&&"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports),s=450,n=function(e){this.parameter="object"===("undefined"==typeof e?"undefined":_typeof(e))?e:{},this.init()};n.prototype={init:function(){this.el=this.parameter.el,this.el?(this.el=o.method.getDom(this.el),this.el?this.variable():i(1,this.parameter.el)):i(0)},variable:function(){this.anim="fade"===this.parameter.anim||"default"===this.parameter.anim?this.parameter.anim:"default",this.elBox=this.el.children[0],this.elItem=this.elBox.children,this.time=Number(this.parameter.time)>=600?this.parameter.time:3e3,this.index=this.parameter.index||0,this.automaticTimer="",this.arrow="boolean"!=typeof this.parameter.arrow||this.parameter.arrow,this.indicator="boolean"!=typeof this.parameter.indicator||this.parameter.indicator,this.autoplay="boolean"!=typeof this.parameter.autoplay||this.parameter.autoplay,this.callback="function"==typeof this.parameter.callback?this.parameter.callback:function(){},this.index>=this.elItem.length&&(this.index=0),this.skeleton()},skeleton:function(){if(this.arrow&&(this.arrowLeft=o.method.addDom('<div class="kxui-carousel-arrow kxui-carousel-arrowLeft"><i class="kxui-icon kxui-icon-arrowLeft"></i></div>'),this.arrowRight=o.method.addDom('<div class="kxui-carousel-arrow kxui-carousel-arrowRight"><i class="kxui-icon kxui-icon-arrowRight"></i></div>'),this.el.appendChild(this.arrowLeft),this.el.appendChild(this.arrowRight)),this.indicator){this.indicatorBox=o.method.addDom('<ul class="kxui-carousel-indicator"></ul>'),this.indicatorSpot=[];for(var e=0;e<this.elItem.length;e++){var t=o.method.addDom('<li class="kxui-carousel-indicatorSpot"></li>');this.indicatorSpot.push(t),this.indicatorBox.appendChild(t)}this.el.appendChild(this.indicatorBox)}this.dynamicStyle()},dynamicStyle:function(){if(o.method.atrDom(this.elBox,"ondragstart","return false"),o.method.addClass(this.elItem[this.index],"kxui-carousel-item-this"),"default"===this.anim){var e=this.commonIndex(this.index-1),t=this.commonIndex(this.index+1);o.method.addClass(this.elItem[e],"kxui-carousel-item-front"),o.method.addClass(this.elItem[t],"kxui-carousel-item-after")}if(this.arrow&&(this.arrowLeft.style.top=this.el.offsetHeight/2-24+"px",this.arrowRight.style.top=this.el.offsetHeight/2-24+"px"),this.indicator&&(this.indicatorBox.style.left=this.el.offsetWidth/2-this.indicatorBox.offsetWidth/2+"px",o.method.addClass(this.indicatorSpot[this.index],"kxui-carousel-indicatorSpot-this")),"fade"===this.anim)for(var i=0;i<this.elItem.length;i++)o.method.addClass(this.elItem[i],"kxui-carousel-item-fade");this.event(),this.autoplayMethod()},event:function(){var e=this;if(e.arrow){var i=function a(i){t(i),e.preposition(),e.index=e.index-1,e.postposition(!0,"hierarchyLeft"),e.arrowLeft.removeEventListener("click",a,!1),setTimeout(function(){e.arrowLeft.addEventListener("click",a)},s)},o=function n(i){t(i),e.preposition(),e.index=e.index+1,e.postposition(!0),e.arrowRight.removeEventListener("click",n,!1),setTimeout(function(){e.arrowRight.addEventListener("click",n)},s)};e.arrowLeft.addEventListener("click",i),e.arrowRight.addEventListener("click",o)}e.indicator&&!function(){for(var i=!0,o=function(o){e.indicatorSpot[o].onclick=function(a){if(t(a),i){var n=e.index,r="",d=e.commonIndex(e.index-1),l=e.commonIndex(e.index+1);o!==d&&o!==l?(e.index>o?r="left":e.index<o&&(r="right"),e.preposition(o,r),e.index=o,e.postposition(!0,r,n)):(e.preposition(),e.index=o,e.postposition(!0,d===e.index?"hierarchyLeft":"")),i=!1,setTimeout(function(){i=!0},s)}}},a=0;a<e.indicatorSpot.length;a++)o(a)}(),e.frameOper()},frameOper:function(){function e(e){i.dowmX=o.method.mouse(e).x,i.elBox.addEventListener(n,t)}function t(r){i.dowmX-o.method.mouse(r).x>50?(i.preposition(),i.index=i.index+1,i.postposition(!0)):i.dowmX-o.method.mouse(r).x<-50&&(i.preposition(),i.index=i.index-1,i.postposition(!0,"hierarchyLeft")),i.elBox.removeEventListener(a,e,!1),i.elBox.removeEventListener(n,t,!1),setTimeout(function(){i.elBox.addEventListener(a,e)},s)}var i=this,a="pc"===o.info().device?"mousedown":"touchstart",n="pc"===o.info().device?"mouseup":"touchend";i.elBox.addEventListener(a,e)},autoplayMethod:function(){var e=this;this.autoplay&&(e.automaticTimer=setInterval(function(){e.preposition(),e.index=e.index+1,e.postposition()},e.time))},preposition:function(e,t){if("default"===this.anim){for(var i=0;i<this.elItem.length;i++)o.method.delClass(this.elItem[i],"kxui-carousel-item-front"),o.method.delClass(this.elItem[i],"kxui-carousel-item-after");"left"===t?o.method.addClass(this.elItem[e],"kxui-carousel-item-front"):"right"===t&&o.method.addClass(this.elItem[e],"kxui-carousel-item-after")}t&&"fade"!==this.anim||o.method.delClass(this.elItem[this.index],"kxui-carousel-item-this"),this.indicator&&o.method.delClass(this.indicatorSpot[this.index],"kxui-carousel-indicatorSpot-this")},postposition:function(e,t,i){var a=this;if(a.index=a.commonIndex(a.index),"default"===this.anim){var n="hierarchyLeft"===t?"left":"right",r=a.commonIndex(a.index-1),d=a.commonIndex(a.index+1);o.method.addClass(a.elItem[r],"kxui-carousel-item-front"),o.method.addClass(a.elItem[d],"kxui-carousel-item-after"),"left"!==t&&"right"!==t||setTimeout(function(){o.method.delClass(a.elItem[a.index],"kxui-carousel-item-front"),o.method.delClass(a.elItem[a.index],"kxui-carousel-item-after"),"left"===t?o.method.addClass(a.elItem[i],"kxui-carousel-item-after"):"right"===t&&(a.hierarchy("right"),o.method.addClass(a.elItem[i],"kxui-carousel-item-front")),setTimeout(function(){o.method.delClass(a.elItem[i],"kxui-carousel-item-this"),o.method.delClass(a.elItem[i],"kxui-carousel-item-after"),o.method.delClass(a.elItem[i],"kxui-carousel-item-front")},s)}),a.hierarchy(n)}o.method.addClass(a.elItem[a.index],"kxui-carousel-item-this"),a.indicator&&o.method.addClass(a.indicatorSpot[a.index],"kxui-carousel-indicatorSpot-this"),e&&(clearTimeout(a.automaticTimer),clearInterval(a.automaticTimer),a.automaticTimer=setTimeout(function(){a.autoplayMethod()},3e3)),a.callback(a.index,a.elItem[a.index])},commonIndex:function(e){return e<0?e=this.elItem.length-1:e>=this.elItem.length&&(e=0),e},hierarchy:function(e){for(var t=0;t<this.elItem.length;t++)this.elItem[t].className.indexOf("left"===e?"kxui-carousel-item-after":"kxui-carousel-item-front")>=0?o.method.addClass(this.elItem[t],"kxui-carousel-item-zIndex"):o.method.delClass(this.elItem[t],"kxui-carousel-item-zIndex")}};var r=function(){this.name="Carousel",this.info="Provide carousel solution"};r.fn=r.prototype,r.fn.binding=function(e){this.logic=new n(e),delete this.logic},o.carousel=new r,a&&(o.carousel=module.exports=new r)}(window);