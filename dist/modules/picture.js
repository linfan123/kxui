/**
 * method kxui
 * version 1.3.1
 * author Lkx
 * create time 2018.05.31
 * update time 2018.10.20
 * website http://www.kxui.org
 */

"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var i=t.kxui,e="undefined"!=typeof module&&"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports),o=function(t){this.parameter="object"===("undefined"==typeof t?"undefined":_typeof(t))?t:{},this.size="object"===_typeof(this.parameter.size)?this.parameter.size:{},this.carousel="object"===_typeof(this.parameter.carousel)?this.parameter.carousel:{},this.variable()};o.prototype={variable:function(){this.sizeWidth=Number(this.size.width)||"",this.sizeHeight=Number(this.size.height)||"",this.imgWidth=this.sizeWidth?this.sizeWidth:(document.documentElement.clientWidth||document.body.clientWidth)-120,this.imgHeight=this.sizeHeight?this.sizeHeight:(document.documentElement.clientHeight||document.body.clientHeight)-120,this.id=Math.ceil(10*Math.random()),this.agg=this.parameter.agg,this.closeTime=null,this.index=this.carousel.index,this.arrow=this.carousel.arrow,this.indicator=this.carousel.indicator,this.time=this.carousel.time,this.autoplay="boolean"==typeof this.carousel.autoplay&&this.carousel.autoplay,this.anim=this.carousel.anim,this.callback=this.carousel.callback,this.skeleton()},skeleton:function(){i.method.addClass(i.method.getDom("html",!0),"kxui-picture-html"),i.method.addClass(i.method.getDom("body",!0),"kxui-picture-body"),this.mask=i.method.addDom('<div class="kxui-picture"></div>'),this.carousel=i.method.addDom('<div id="kxui-picture-'+this.id+'" class="kxui-carousel"></div>'),this.box=i.method.addDom('<div class="kxui-carousel-box"></div>');for(var t=0;t<this.agg.length;t++){this.item=i.method.addDom('<div class="kxui-carousel-item"></div>'),this.img=i.method.addDom('<img src="'+this.agg[t].src+'">');var e=this.cropImage(this.img);this.img.src=e,this.item.appendChild(this.img),this.box.appendChild(this.item)}this.carousel.appendChild(this.box),this.mask.appendChild(this.carousel),i.method.getDom("body",!0).appendChild(this.mask),this.dynamicStyle()},dynamicStyle:function(){this.carousel.style.width=this.imgWidth+"px",this.carousel.style.height=this.imgHeight+"px",this.carousel.style.marginTop=this.mask.offsetHeight/2-this.carousel.offsetHeight/2+"px",this.useCarousel()},useCarousel:function(){var t=this;i.carousel.binding({el:"#kxui-picture-"+t.id,index:t.index,arrow:t.arrow,indicator:t.indicator,time:t.time,autoplay:t.autoplay,anim:t.anim,callback:t.callback}),t.showAnimation(),t.event()},showAnimation:function(){this.mask.style.opacity="1"},event:function(){var t=this;t.mask.onclick=function(){return t.mask.style.opacity="0",clearTimeout(t.closeTime),t.closeTime=setTimeout(function(){i.method.getDom(".kxui-picture-body").removeChild(t.mask),i.method.delClass(i.method.getDom("html",!0),"kxui-picture-html"),i.method.delClass(i.method.getDom("body",!0),"kxui-picture-body")},300),!1}},cropImage:function(t){var i=t.naturalWidth,e=t.naturalHeight,o=i/e,s=this.imgWidth,a=this.imgHeight,h=0,n=this.imgHeight/2-s/o/2,d=document.createElement("canvas"),m=d.getContext("2d");return d.width=s,d.height=a,m.drawImage(t,h,n,s,s/o),d.toDataURL("image/jpeg",.9)}},function(){i.carousel||i.use("carousel",function(){},!1)}();var s=function(){this.name="Picture",this.info="Image magnification scheme"};s.fn=s.prototype,s.fn.enlarge=function(t){this.logic=new o(t),delete this.logic},i.picture=new s,e&&(i.picture=module.exports=new s)}(window);